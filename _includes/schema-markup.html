<script type="application/ld+json" id="schema-markup-data">
{
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "Fatboy Financial Planner",
  "applicationCategory": "FinanceApplication",
  "operatingSystem": "Windows 10, Windows 11, Linux",
  "softwareVersion": "3.3",
  "description": "Free retirement planning software with optional Pro upgrade. No subscriptions. Desktop application with advanced features like Roth conversion optimization, Monte Carlo analysis, and tax planning.",
  "url": "{{ site.url }}",
  "screenshot": "{{ site.url }}/assets/images/optimized/plan_summary-800w.png",
  "offers": [
    {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD",
      "name": "Free Version",
      "description": "Core retirement planning with 3 scenarios, 15-year planning period, portfolio tracking, cash flow projections, and Social Security planning",
      "availability": "https://schema.org/InStock"
    },
    {
      "@type": "Offer",
      "price": "149",
      "priceCurrency": "USD",
      "name": "Pro Version - Founding Member",
      "description": "Lifetime license with unlimited scenarios, advanced Roth optimizer, Monte Carlo analysis, goal solver, Sankey diagrams, and editable tax parameters",
      "availability": "https://schema.org/LimitedAvailability",
      "eligibleQuantity": {
        "@type": "QuantitativeValue",
        "value": "200",
        "unitText": "founding members"
      }
    }
  ],
  "featureList": [
    "Roth conversion optimizer",
    "Monte Carlo simulation analysis",
    "Tax optimization and planning",
    "Multiple scenario planning and comparison",
    "Cash flow projections and visualization",
    "Social Security optimization",
    "Editable tax parameters for future law modeling",
    "Sankey cash flow diagrams",
    "Interactive goal solver",
    "Portfolio allocation tracking",
    "RMD and IRMAA calculations",
    "Withdrawal strategy planning",
    "Desktop application - data stays local",
    "No cloud storage or data harvesting"
  ],
  "creator": {
    "@type": "Organization",
    "name": "Fatboy Software",
    "url": "{{ site.url }}"
  },
  "downloadUrl": "https://github.com/sathomas501/FB-Financial-Planner/releases/latest",
  "installUrl": "https://github.com/sathomas501/FB-Financial-Planner/releases/latest",
  "softwareRequirements": "Windows 10/11 or Linux; 2GB RAM minimum (4GB recommended); 100MB disk space",
  "memoryRequirements": "2GB minimum, 4GB recommended",
  "storageRequirements": "100MB"
}
</script>

<script>
// Update schema markup with latest release info dynamically
(function() {
  'use strict';

  const GITHUB_REPO = 'sathomas501/FB-Financial-Planner';
  const GITHUB_API_URL = `https://api.github.com/repos/${GITHUB_REPO}/releases/latest`;

  async function updateSchemaMarkup() {
    try {
      const response = await fetch(GITHUB_API_URL);
      if (!response.ok) return;

      const data = await response.json();
      const version = data.tag_name;
      const assets = data.assets;

      // Find the installer asset
      const installerPattern = /Setup.*NSIS\.exe$/i;
      const installerAsset = assets.find(asset => installerPattern.test(asset.name));

      if (!installerAsset) return;

      // Update the schema markup
      const schemaElement = document.getElementById('schema-markup-data');
      if (schemaElement) {
        const schemaData = JSON.parse(schemaElement.textContent);
        schemaData.softwareVersion = version.replace('v', '');
        schemaData.downloadUrl = installerAsset.browser_download_url;
        schemaData.installUrl = installerAsset.browser_download_url;
        schemaElement.textContent = JSON.stringify(schemaData, null, 2);
        console.log('Schema markup updated with version:', version);
      }
    } catch (error) {
      console.log('Schema markup using fallback values');
    }
  }

  // Run after download updater has a chance to fetch
  setTimeout(updateSchemaMarkup, 1000);
})();
</script>
